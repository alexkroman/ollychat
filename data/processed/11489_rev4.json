[
  {
    "name": "Loki logs",
    "description": "anything except \"ppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppp\"",
    "queries": [
      " !=\"ppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppppp\" !~ \"info\""
    ]
  },
  {
    "name": "Missing entries rate",
    "description": "counts log entries not received within the maxWait duration via both websocket and direct query",
    "queries": [
      "sum(rate(loki_canary_missing_entries_total[30m]))"
    ]
  },
  {
    "name": "Unexpected entries rate",
    "description": "counts a log entry received which was not expected (e.g. received after reported missing)",
    "queries": [
      "sum(rate(loki_canary_unexpected_entries_total[30m]))"
    ]
  },
  {
    "name": "Out of order entries rate",
    "description": "counts log entries received with a timestamp more recent than the others in the queue",
    "queries": [
      "sum(rate(loki_canary_out_of_order_entries_total[30m]))"
    ]
  },
  {
    "name": "Total entries rate",
    "description": "counts log entries written to the file",
    "queries": [
      "sum(rate(loki_canary_entries_total[30m]))"
    ]
  },
  {
    "name": "Duplicate entries rate",
    "description": "counts a log entry received more than one time",
    "queries": [
      "sum(rate(loki_canary_duplicate_entries_total[30m]))"
    ]
  },
  {
    "name": "Total spots rate",
    "description": "total count of entries spot checked",
    "queries": [
      "sum(rate(loki_canary_spot_check_entries_total[30m]))"
    ]
  },
  {
    "name": "Total spots missing rate",
    "description": "log entries not received when directly queried as part of spot checking",
    "queries": [
      "sum(rate(loki_canary_spot_check_missing_entries_total[30m]))"
    ]
  },
  {
    "name": "Average response latency [1m]",
    "description": "is how long it takes for log lines to be returned from Loki in seconds.",
    "queries": [
      "sum(rate(loki_canary_response_latency_seconds_sum[30m])) / sum(rate(loki_canary_response_latency_seconds_count[30m]))",
      "sum(rate(loki_canary_response_latency_seconds_bucket[30m]))",
      "sum(rate(loki_canary_response_latency_seconds_bucket[30m]))",
      "sum(rate(loki_canary_response_latency_seconds_bucket[30m]))",
      "sum(rate(loki_canary_response_latency_seconds_bucket[30m]))",
      "sum(rate(loki_canary_response_latency_seconds_bucket[30m]))",
      "sum(rate(loki_canary_response_latency_seconds_bucket[30m]))",
      "sum(rate(loki_canary_response_latency_seconds_bucket[30m]))",
      "sum(rate(loki_canary_response_latency_seconds_bucket[30m]))",
      "sum(rate(loki_canary_response_latency_seconds_bucket[30m]))",
      "sum(rate(loki_canary_response_latency_seconds_bucket[30m]))",
      "sum(rate(loki_canary_response_latency_seconds_bucket[30m]))"
    ]
  },
  {
    "name": "Metric test diff",
    "description": "difference between expected and actual metric count, this should be something around 5*number_of_loki_canary_instances",
    "queries": [
      "sum(loki_canary_metric_test_expected) - sum(loki_canary_metric_test_actual)"
    ]
  },
  {
    "name": "Metric test expected, actual",
    "description": "",
    "queries": [
      "sum(loki_canary_metric_test_expected)",
      "sum(loki_canary_metric_test_actual)"
    ]
  },
  {
    "name": "Websocket missing entries rate",
    "description": "counts log entries not received within the wait duration via the websocket connection",
    "queries": [
      "sum(rate(loki_canary_websocket_missing_entries_total[30m]))"
    ]
  },
  {
    "name": "Websocket reconnects rate",
    "description": "counts every time the websocket connection has to reconnect",
    "queries": [
      "sum(rate(loki_canary_ws_reconnects_total[30m]))"
    ]
  },
  {
    "name": "Websocket pings rate",
    "description": "every time the websocket receives a ping message",
    "queries": [
      "sum(rate(loki_canary_ws_pings_total[30m]))"
    ]
  }
]