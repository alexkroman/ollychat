[
  {
    "name": "Rule Execution Success Rate",
    "description": "",
    "queries": [
      "sum(kyverno_policy_results_total)*100/sum(kyverno_policy_results_total)"
    ]
  },
  {
    "name": "Cluster Policies",
    "description": "",
    "queries": [
      "count(count(kyverno_policy_rule_info_total==1) by (policy_name))"
    ]
  },
  {
    "name": "Policies",
    "description": "",
    "queries": [
      "count(count(kyverno_policy_rule_info_total==1) by (policy_name))"
    ]
  },
  {
    "name": "Background Scans Success Rate",
    "description": "",
    "queries": [
      "sum(kyverno_policy_results_total)*100/sum(kyverno_policy_results_total)"
    ]
  },
  {
    "name": "Validate Rules",
    "description": "",
    "queries": [
      "count(kyverno_policy_rule_info_total==1)"
    ]
  },
  {
    "name": "Mutate Rules",
    "description": "",
    "queries": [
      "count(kyverno_policy_rule_info_total==1)"
    ]
  },
  {
    "name": "Generate Rules",
    "description": "",
    "queries": [
      "count(kyverno_policy_rule_info_total==1)"
    ]
  },
  {
    "name": "Admission Review Results (per-rule)",
    "description": "",
    "queries": [
      "sum(kyverno_policy_results_total) by (rule_result)"
    ]
  },
  {
    "name": "Background Scan Results (per-rule)",
    "description": "",
    "queries": [
      "sum(kyverno_policy_results_total) by (rule_result)"
    ]
  },
  {
    "name": "Policy Failures",
    "description": "",
    "queries": [
      "sum(sum(kyverno_policy_results_total) by (policy_name, policy_type)) by (policy_type)"
    ]
  },
  {
    "name": "Admission Review Results (per-policy)",
    "description": "",
    "queries": [
      "sum(sum(kyverno_policy_results_total) by (policy_name, rule_result)) by (rule_result)"
    ]
  },
  {
    "name": "Background Scan Results (per-policy)",
    "description": "",
    "queries": [
      "sum(sum(kyverno_policy_results_total) by (policy_name, rule_result)) by (rule_result)"
    ]
  },
  {
    "name": "Active Policies (by policy type)",
    "description": "",
    "queries": [
      "count(count(kyverno_policy_rule_info_total==1) by (policy_name, policy_type)) by (policy_type)"
    ]
  },
  {
    "name": "Active Policies (by policy validation action)",
    "description": "",
    "queries": [
      "count(count(kyverno_policy_rule_info_total==1) by (policy_name, policy_validation_mode)) by (policy_validation_mode)"
    ]
  },
  {
    "name": "Active Policies running in background mode",
    "description": "",
    "queries": [
      "count(count(kyverno_policy_rule_info_total==1) by (policy_name, policy_type)) by (policy_type)"
    ]
  },
  {
    "name": "Active Namespaced Policies (by namespaces)",
    "description": "",
    "queries": [
      "count(count(kyverno_policy_rule_info_total==1) by (policy_name, policy_namespace)) by (policy_namespace)"
    ]
  },
  {
    "name": "Active Rules (by rule type)",
    "description": "",
    "queries": [
      "count(kyverno_policy_rule_info_total==1) by (rule_type)"
    ]
  },
  {
    "name": "Average Rule Execution Latency",
    "description": "",
    "queries": [
      "avg(kyverno_policy_execution_duration_seconds_sum) by (rule_type)"
    ]
  },
  {
    "name": "Average Policy Execution Latency",
    "description": "",
    "queries": [
      "avg(sum(kyverno_policy_execution_duration_seconds_sum) by (policy_name, policy_type)) by (policy_type)"
    ]
  },
  {
    "name": "Overall Average Rule Execution Latency",
    "description": "",
    "queries": [
      "avg(kyverno_policy_execution_duration_seconds_sum)"
    ]
  },
  {
    "name": "Overall Average Policy Execution Latency",
    "description": "",
    "queries": [
      "avg(sum(kyverno_policy_execution_duration_seconds_sum) by (policy_name, policy_type))"
    ]
  },
  {
    "name": "Avg - Admission Review Duration (by operation)",
    "description": "",
    "queries": [
      "avg(kyverno_admission_requests_total) by (resource_request_operation)"
    ]
  },
  {
    "name": "Avg - Admission Review Duration (by resource kind)",
    "description": "",
    "queries": [
      "sum(kyverno_admission_requests_total) by (resource_kind)"
    ]
  },
  {
    "name": "Rate - Incoming Admission Requests (last 5m)",
    "description": "",
    "queries": [
      "sum(rate(kyverno_admission_requests_total[5m]))"
    ]
  },
  {
    "name": "Avg - Overall Admission Review Duration",
    "description": "",
    "queries": [
      "avg(kyverno_admission_review_duration_seconds_sum)"
    ]
  },
  {
    "name": "Policy Changes (by change type)",
    "description": "",
    "queries": [
      "sum(kyverno_policy_changes_total) by (policy_change_type)"
    ]
  },
  {
    "name": "Policy Changes (by policy type)",
    "description": "",
    "queries": [
      "sum(kyverno_policy_changes_total) by (policy_type)"
    ]
  },
  {
    "name": "Total Policy Changes",
    "description": "",
    "queries": [
      "sum(kyverno_policy_changes_total)"
    ]
  },
  {
    "name": "Rate - Policy Changes Happening (last 5m)",
    "description": "",
    "queries": [
      "sum(rate(kyverno_admission_requests_total[5m]))"
    ]
  },
  {
    "name": "Admission Requests (by operation)",
    "description": "",
    "queries": [
      "sum(kyverno_admission_requests_total) by (resource_request_operation)"
    ]
  },
  {
    "name": "Admission Requests (by resource kind)",
    "description": "",
    "queries": [
      "sum(kyverno_admission_requests_total) by (resource_kind)"
    ]
  },
  {
    "name": "Total Admission Requests",
    "description": "",
    "queries": [
      "sum(kyverno_admission_requests_total)"
    ]
  }
]