[
  {
    "name": "Flows processed Per Node",
    "description": "",
    "queries": [
      "avg(sum(rate(hubble_flows_processed_total[1m])) by (pod))",
      "min(sum(rate(hubble_flows_processed_total[1m])) by (pod))",
      "max(sum(rate(hubble_flows_processed_total[1m])) by (pod))"
    ]
  },
  {
    "name": "Flows Types",
    "description": "",
    "queries": [
      "sum(rate(hubble_flows_processed_total[1m])) by (pod, type)"
    ]
  },
  {
    "name": "L7 Flow Distribution",
    "description": "",
    "queries": [
      "sum(rate(hubble_flows_processed_total[1m])) by (pod, subtype)"
    ]
  },
  {
    "name": "Trace Flow Distribution",
    "description": "",
    "queries": [
      "sum(rate(hubble_flows_processed_total[1m])) by (pod, subtype)"
    ]
  },
  {
    "name": "Forwarded vs Dropped",
    "description": "",
    "queries": [
      "sum(rate(hubble_flows_processed_total[1m])) by (pod, verdict)"
    ]
  },
  {
    "name": "Drop Reason",
    "description": "",
    "queries": [
      "sum(rate(hubble_drop_total[1m])) by (pod, reason)"
    ]
  },
  {
    "name": "Protocol Usage",
    "description": "",
    "queries": [
      "sum (rate(hubble_port_distribution_total[1m])) by (pod, protocol)"
    ]
  },
  {
    "name": "Top 10 Port Distribution",
    "description": "",
    "queries": [
      "topk(10, sum (rate(hubble_port_distribution_total[1m])) by (pod, port, protocol))"
    ]
  },
  {
    "name": "TCPv4",
    "description": "",
    "queries": [
      "sum(rate(hubble_tcp_flags_total[1m])) by (pod, flag)"
    ]
  },
  {
    "name": "Missing TCPv4 SYN-ACKs",
    "description": "",
    "queries": [
      "sum(rate(hubble_tcp_flags_total[1m])) by (pod) - sum(rate(hubble_tcp_flags_total[1m])) by (pod)"
    ]
  },
  {
    "name": "TCPv6",
    "description": "",
    "queries": [
      "sum(rate(hubble_tcp_flags_total[1m])) by (pod, flag)"
    ]
  },
  {
    "name": "Missing TCPv6 SYN-ACKs",
    "description": "",
    "queries": [
      "sum(rate(hubble_tcp_flags_total[1m])) by (pod) - sum(rate(hubble_tcp_flags_total[1m])) by (pod)"
    ]
  },
  {
    "name": "ICMPv4",
    "description": "",
    "queries": [
      "sum(rate(hubble_icmp_total[1m])) by (pod, type)"
    ]
  },
  {
    "name": "Missing ICMPv4 Echo-Reply",
    "description": "",
    "queries": [
      "sum(rate(hubble_icmp_total[1m])) by (pod) - sum(rate(hubble_icmp_total[1m])) by (pod)"
    ]
  },
  {
    "name": "ICMPv6",
    "description": "",
    "queries": [
      "sum(rate(hubble_icmp_total[1m])) by (pod, type)"
    ]
  },
  {
    "name": "Missing ICMPv6 Echo-Reply",
    "description": "",
    "queries": [
      "sum(rate(hubble_icmp_total[1m])) by (pod) - sum(rate(hubble_icmp_total[1m])) by (pod)"
    ]
  },
  {
    "name": "Denies by Reason",
    "description": "",
    "queries": [
      "sum(rate(hubble_drop_total[1m])) by (pod, reason)"
    ]
  },
  {
    "name": "Denied Packets by Protocol",
    "description": "",
    "queries": [
      "sum(rate(hubble_drop_total[1m])) by (pod, protocol)"
    ]
  },
  {
    "name": "Top 10 Source Pods with Denied Packets",
    "description": "",
    "queries": [
      "topk(10, sum(rate(hubble_drop_total[1m])) by (pod, source))"
    ]
  },
  {
    "name": "Top 10 Destination Pods with Denied Packets",
    "description": "",
    "queries": [
      "topk(10, sum(rate(hubble_drop_total[1m])) by (pod, destination))"
    ]
  },
  {
    "name": "HTTP Requests",
    "description": "",
    "queries": [
      "sum(rate(hubble_http_requests_total[1m])) by (pod, method)"
    ]
  },
  {
    "name": "HTTP responses",
    "description": "",
    "queries": [
      "sum(rate(hubble_http_responses_total[1m])) by (pod, status)"
    ]
  },
  {
    "name": "HTTP Request/Response Latency (p50)",
    "description": "",
    "queries": [
      "histogram_quantile(0.5, rate(hubble_http_request_duration_seconds_bucket[1m]))"
    ]
  },
  {
    "name": "HTTP Request/Response Latency (p99)",
    "description": "",
    "queries": [
      "histogram_quantile(0.99, rate(hubble_http_request_duration_seconds_bucket[1m]))"
    ]
  },
  {
    "name": "HTTP Protocol Usage",
    "description": "",
    "queries": [
      "sum(rate(hubble_http_requests_total[5m])) by (pod, protocol)"
    ]
  },
  {
    "name": "DNS Requests",
    "description": "",
    "queries": [
      "sum(rate(hubble_dns_queries_total[1m])) by (pod, qtypes)"
    ]
  },
  {
    "name": "DNS responses",
    "description": "",
    "queries": [
      "sum(rate(hubble_dns_responses_total[1m])) by (pod, qtypes)"
    ]
  },
  {
    "name": "Missing DNS Responses",
    "description": "",
    "queries": [
      "sum(rate(hubble_dns_queries_total[1m])) by (pod, qtypes) - sum(rate(hubble_dns_responses_total[1m])) by (pod, qtypes)"
    ]
  },
  {
    "name": "DNS Response Record Type",
    "description": "",
    "queries": [
      "sum(rate(hubble_dns_response_types_total[1m])) by (pod, type)"
    ]
  },
  {
    "name": "DNS Response IPs Returned",
    "description": "",
    "queries": [
      "sum(rate(hubble_dns_responses_total[1m])) by (pod,ips_returned)"
    ]
  },
  {
    "name": "DNS Errors",
    "description": "",
    "queries": [
      "sum(rate(hubble_dns_responses_total[1m])) by (pod, qtypes, rcode)"
    ]
  },
  {
    "name": "Pods with DNS errors",
    "description": "",
    "queries": [
      "topk(10,sum(rate(hubble_dns_responses_total[1m])) by (pod, destination))"
    ]
  },
  {
    "name": "Top 10 DNS Queries per minute",
    "description": "",
    "queries": [
      "topk(10, sum(rate(hubble_dns_queries_total[10m])*60) by (query, qtypes))"
    ]
  }
]